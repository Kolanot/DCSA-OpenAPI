openapi: 3.0.0
info:
  version: '0.1.0'
  title: 'DCSA.org Interface Track Standards Open Api Specification'
  description: 'Open Api Specification for the DCSA Interface Tracking Standards'
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  contact:
    name: Digital Container Shipping Association (DCSA)
    url: https://dcsa.org
    email: info@dcsa.org
tags:
  - name: Shipments
    description: Shipment operations
  - name: Equipments
    description: Equipment operations
paths:
  /shipments/{bookingReference}/events:
    get:
      tags:
        - Shipments
      summary: Find events by Booking Reference
      description: Returns all events of a single shipment
      parameters:
        - in: path
          name: bookingReference
          description: Booking Reference of shipment to return
          required: true
          schema:
            $ref: '#/components/schemas/bookingReference'
        - in: query
          name: equipmentReference
          description: Equipment Reference of equipment to filter events by
          required: false
          schema:
            $ref: '#/components/schemas/equipmentReference'
        - in: query
          name: transportReference
          description: Transport Reference of transport to filter events by
          required: false
          schema:
            $ref: '#/components/schemas/transportReference'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/events'
            application/xml:
              schema:
                $ref: '#/components/schemas/events'
        '400':
          description: Invalid Booking Reference supplied
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Booking Reference not found
  /shipments/billOfLadingNumber={billOfLadingNumber}/events:
    get:
      tags:
        - Shipments
      summary: Find events by Bill of Lading Number
      description: Returns all events of a single shipment
      parameters:
        - in: path
          name: billOfLadingNumber
          description: Bill of Lading Number of shipment to return
          required: true
          schema:
            $ref: '#/components/schemas/billOfLadingNumber'
        - in: query
          name: equipmentReference
          description: Equipment Reference of equipment to filter events by
          required: false
          schema:
            $ref: '#/components/schemas/equipmentReference'
        - in: query
          name: transportReference
          description: Transport Reference of transport to filter events by
          required: false
          schema:
            $ref: '#/components/schemas/transportReference'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/events'
            application/xml:
              schema:
                allOf:
                  - $ref: '#/components/schemas/events'
        '400':
          description: Invalid Booking Reference supplied
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Booking Reference not found
  /equipments/{equipmentReference}/activeShipmentEvents:
    get:
      tags:
        - Equipments
      summary: Find active shipment events related to Equipment Reference
      description: Returns a list of active events for a single equipment
      parameters:
      - name: equipmentReference
        in: path
        description: Equipment Reference of the active events to return
        required: true
        schema:
          $ref: '#/components/schemas/equipmentReference'
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/equipmentEvents'
            application/xml:
              schema:
                $ref: '#/components/schemas/equipmentEvents'

        '400':
          description: Invalid Equipment Reference supplied
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Equipment Reference not found
components:
  schemas:
    event:
      description: The event entity is described as a generalization of all the specific event categories. An event always takes place in relation to a shipment and can additionally be linked to a transport or an equipment
      type: object
      properties:
        eventID:
          $ref: '#/components/schemas/eventID'
        eventDateTime:
          $ref: '#/components/schemas/eventDateTime'
        eventClassifierCode:
          $ref: '#/components/schemas/eventClassifierCode'
        eventTypeCode:
          $ref: '#/components/schemas/eventTypeCode'
      required:
        - eventID
        - eventDateTime
        - eventClassifierCode
        - eventTypeCode
    shipmentEvent:
      description: The shipment event entity is a specialization of the event entity to support specification of data that only applies to a shipment event.
      allOf:
        - $ref: '#/components/schemas/event'
        - type: object
          properties:
            informationTypeCode:
              $ref: '#/components/schemas/informationTypeCode'
          required:
            - informationTypeCode
    transportEvent:
      description: The transport event entity is a specialization of the event entity to support specification of data that only applies to a transport event.
      allOf:
        - $ref: '#/components/schemas/event'
        - type: object
          properties:
            transportReference:
              $ref: '#/components/schemas/transportReference'
            transportLegReference:
              $ref: '#/components/schemas/transportLegReference'
            facilityType:
              $ref: '#/components/schemas/facilityType'
            UNLocationCode:
              $ref: '#/components/schemas/UNLocationCode'
            facilityCode:
              $ref: '#/components/schemas/facilityCode'
            otherFacility:
              $ref: '#/components/schemas/otherFacility'
          required:
            - transportReference
            - transportLegReference
            - facilityType
            - UNLocationCode
            - facilityCode
    equipmentEvent:
      description: The equipment event entity is a specialization of the event entity to support specification of data that only applies to an equipment event.
      allOf:
        - $ref: '#/components/schemas/event'
        - type: object
          properties:
            equipmentReference:
              $ref: '#/components/schemas/equipmentReference'
            facilityType:
              $ref: '#/components/schemas/facilityType'
            UNLocationCode:
              $ref: '#/components/schemas/UNLocationCode'
            facilityCode:
              $ref: '#/components/schemas/facilityCode'
            otherFacility:
              $ref: '#/components/schemas/otherFacility'
            emptyIndicatorCode:
              $ref: '#/components/schemas/emptyIndicatorCode'
          required:
            - equipmentReference
            - facilityType
            - UNLocationCode
            - facilityCode
            - emptyIndicatorCode
    transportEquipmentEvent:
      description: The transport equipment event entity is a specialization of the event entity to support specification of data that applies to both transport and equipment events.
      allOf:
        - $ref: '#/components/schemas/event'
        - type: object
          properties:
            transportReference:
              $ref: '#/components/schemas/transportReference'
            transportLegReference:
              $ref: '#/components/schemas/transportLegReference'
            equipmentReference:
              $ref: '#/components/schemas/equipmentReference'
            facilityType:
              $ref: '#/components/schemas/facilityType'
            UNLocationCode:
              $ref: '#/components/schemas/UNLocationCode'
            facilityCode:
              $ref: '#/components/schemas/facilityCode'
            otherFacility:
              $ref: '#/components/schemas/otherFacility'
            emptyIndicatorCode:
              $ref: '#/components/schemas/emptyIndicatorCode'
          required:
            - transportReference
            - transportLegReference
            - equipmentReference
            - facilityType
            - UNLocationCode
            - facilityCode
            - emptyIndicatorCode
    events:
      type: object
      description: List of events.
      properties:
        events:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/transportEvent'
              - $ref: '#/components/schemas/shipmentEvent'
              - $ref: '#/components/schemas/equipmentEvent'
              - $ref: '#/components/schemas/transportEquipmentEvent'
            discriminator:
              propertyName: event
      required:
        - events
    equipmentEvents:
      description: List of all equipment-related events for the shipment journey.
      type: object
      properties:
        events:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/equipmentEvent'
              - $ref: '#/components/schemas/transportEquipmentEvent'
            discriminator:
              propertyName: event
      required:
        - events
####String variables below
    bookingReference:
      type: string
      example: ABC709951
      description: The unique identifier for a shipment.
    transportReference:
      type: string
      example: 9648714
      description: The reference for the transport that the shipment is related to.
    equipmentReference:
      type: string
      example: APZU4812090
      description: The unique identifier for the equipment.
    billOfLadingNumber:
      type: string
      example: ABCD421911263977
      description: Bill of Lading is the legal document issued to the customer.
    facilityType:
      type: string
      example: POTE
      description: The code to identify the specific type of facility.
    UNLocationCode:
      type: string
      example: USNYC
      description: UN Location Code identifies a location in the sense of a city / a town / a village.
    facilityCode:
      type: string
      example: AEAUHADT
      description: The code used for identifying the specific facility.
    otherFacility:
      type: string
      example: Depot location or address
      description: An alternative way to capture the facility when no standardized DCSA facility code can be found.
    emptyIndicatorCode:
      type: string
      example: Empty
      description: Code to denote whether the equipment is empty or not.
    informationTypeCode:
      type: string
      example: SRM
      description: The code to identify the type of information that is related to the shipment.
    transportLegReference:
      type: string
      example: 025E
      description: The reference specifying a single section of the complete transport of a shipment. For a vessel this will be the voyage number.
    eventDateTime:
      type: string
      format: date-time
      example: '2019-11-12T07:41:00+08:30'
      description: The date and time that the event took place.
    eventID:
      type: string
      example: 1
      description: The unique identifier for the Equipment Event ID/Transport Event ID/Shipment Event ID.
    eventClassifierCode:
      type: string
      example: ACT
      description: Event Classifier Code (Planned, Estimated or Actual).
    eventTypeCode:
      type: string
      example: ARRI
      description: Unique identifier for Event Type Code.